<launch>
    <arg name="lidar_port" default="/dev/ttyTHS0"/>
    <arg name="use_gui" default="FALSE"/>
    <arg name="camera_model" default="OAK-D-LITE"/>
    <!-- <arg name="base_frame" default="base_link" /> -->

    <node pkg="robot_state_publisher" exec="robot_state_publisher" name="robot_state_publisher" output="screen" args="$(find-pkg-share deepdrive_description)/urdf/deepdrive_deepdrive.urdf"/>

    <node pkg="joint_state_publisher" exec="joint_state_publisher" name="joint_state_publisher" output="screen">
        <param name="use_gui" value="$(var use_gui)"/>
    </node>
    <!-- <node pkg="joint_state_publisher_gui" exec="joint_state_publisher_gui" name="joint_state_publisher_gui"/> -->

    <!-- LIDAR -->
    <!-- https://github.com/ROBOTIS-GIT/hls_lfcd_lds_driver/tree/master/launch -->
    <!-- <node pkg="hls_lfcd_lds_driver" type="hlds_laser_segment_publisher" name="hlds_laser_segment_publisher" output="screen"> -->
    <node pkg="hls_lfcd_lds_driver" exec="hlds_laser_publisher" name="hlds_laser_publisher" output="screen">
        <param name="port" value="$(var lidar_port)"/>
        <param name="frame_id" value="laser"/>
    </node>
    <node pkg="tf2_ros" exec="static_transform_publisher" name="base_link_to_laser" args="0 0 0 3.14159 0 0 base_link laser" output="screen" />

    <!-- Camera -->
    <include file="$(find-pkg-share deepdrive_camera)/launch/camera.launch.xml" />


    <!-- Odometry / localization -->
    <include file="$(find-pkg-share deepdrive_bringup)/launch/localization.launch.py" />

    <!-- Motor Controller -->
    <node pkg="deepdrive_hardware" exec="motor_controller" name="motor_controller" output="screen" />

    <!-- Foxglove Bridge -->
    <!-- https://index.ros.org/p/foxglove_bridge/ -->
    <include file="$(find-pkg-share foxglove_bridge)/launch/foxglove_bridge_launch.xml">
        <arg name="port" value="8765"/>
        <arg name="asset_uri_allowlist" value="[^package://.*.stl$]"/>
        <!-- <arg name="asset_uri_allowlist" default="['^package://(?:\\w+/)*\\w+\\.(?:dae|fbx|glb|gltf|jpeg|jpg|mtl|obj|png|stl|tif|tiff|urdf|webp|xacro)$']" />  Needs double-escape -->
    </include>
</launch>
